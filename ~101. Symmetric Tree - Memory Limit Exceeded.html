<script src="assert.js"></script>
<script>
    /**
     * Definition for a binary tree node. 
     */
    function TreeNode(val) {
        this.val = val;
        this.left = this.right = null;
    }

    /**
    * @param {TreeNode} root
    * @return {boolean}
    */
    var isSymmetric = function (root) {

        if (!root) return true;
        if (!root.left && !root.right) return true;
        if (!root.left || !root.right) return false;

        let array = [root.left, root.right];
        let hasNodeInArray = true;
        let isSymmetric = true;

        while (hasNodeInArray && isSymmetric) {
            if (!isSymmetricArray(array))
                isSymmetric = false;
            else {
                let hasNextLevel = false;
                const nextLevel = [];
                array.forEach(node => {
                    if (!node) {
                        nextLevel.push(null);
                        nextLevel.push(null);
                    }
                    else {
                        hasNextLevel = true;
                        nextLevel.push(node.left);
                        nextLevel.push(node.right);
                    }
                });
                array = nextLevel;
                hasNodeInArray = hasNextLevel;
            }
        }
        return isSymmetric
    };

    function isSymmetricArray(array) {
        const len = array.length;
        const half = len / 2;
        for (let i = 0; i < half; i++) {
            const left = array[i];
            const right = array[len - 1 - i];
            if (left && right) {
                if (left.val !== right.val)
                    return false;
            }
            else if (!left && !right) { }
            else if (!left || !right)
                return false;
        }
        return true;
    };



    const test1 = new TreeNode(1);
    test1.left = new TreeNode(2);
    test1.left.left = new TreeNode(3);
    test1.left.right = new TreeNode(4);
    test1.right = new TreeNode(2);
    test1.right.left = new TreeNode(4);
    test1.right.right = new TreeNode(3);
    assert(true, isSymmetric(test1));


    const test2 = new TreeNode(1);
    test2.left = new TreeNode(2);
    test2.left.right = new TreeNode(3);
    test2.right = new TreeNode(2);
    test2.right.right = new TreeNode(3);
    assert(false, isSymmetric(test2));


</script>